# WebOmSTU

Пример исходного кода и материалы по серверной части курса Web-технологий/Систем программирования.

### Цель проекта: ###

##### Ознакомиться: #####
 - основами функционирования web-систем, включающих серверную и клиентскую часть в виде специализированного приложения;
 - понятием, общей структурой и принципами функционирования web-фреймворков, как средства ускорения разработки серверной части приложения, для упрощения их дальнейшего освоения и использования;
 - основными шаблонами(паттернами) проектирования программного обеспечения;
  
##### Отточить навыки: #####
 - программировния, построения программного обеспечения и применения существующих шаблонов его проектирования;
 - проектирования и работы с базами данных;
 - использования терминала и взаимодействия с Linux-системам;
 - использования системы контроля версий Git
  
### Задача: ###
Разработать собственный простой, легковестный web-фреймворк и реализовать с его помощью серверную часть специализированного приложения по индивидуальному проекту, описаясь на содержимое данного репозитория

### Используемый стек технологий и набор средств разработки: ###
- Контейнер, используемый в качестве виртуального сервера под управлением ОС CentOS (Linux)
- Сервер Apache 2.0
- Язык программирования PHP 7.0
- СУБД MySQL
- Облачная IDE [CodeAnyWhere](https://codeanywhere.com)
- Веб-интерфейс для администрирования СУБД MySQL PHPMyAdmin
- Система контроля версий Git

=================================================================

### Структура проекта: ###
- Каталог [application](https://bitbucket.org/Alexandr1994/webomstu/src/master/application/) - основная часть разрабатываемого web-фреймворка и серверного приложения
- Файл index.php - точка входа в разрабатываемое приложение
- Файл 404.php - временное расположение шаблона ошибки 404
- Файл .htaccess - локальный файл дополнительных настроек сервера Apache

=================================================================

### Текущие задачи: ###

#### 1. ОСНОВА ФРЕЙМВОРКА И СИСТЕМА РОУТИНГА: ####
##### НОВОЕ: #####
- index.php - точка входа(старта) в разрабатываемое приложение (подключение файлов ядра, запуск главного метода системы роутинга)
- .htaccess - локальные настройки сервера (логирование ошибок php, преобразование url RewriteEngine)
- application/core/controller.php - абстрактный контроллер (абстрактный метод index)
- application/core/router.php - класс системы роутинга (хранение списка и добавление роутов, выбор роута по запрошенному url, многоступенчатая проверка существования обработчика, вызов обработчика, правила именования файлов и классов контроллеров)
- application/routes.php - объявление роутов и добавление их в список
- application/controllers/ - набор тестовых контроллеров - наследников абстрактного контроллера

-----------------------------------------------------------------

##### 2. БАЗОВЫЕ СРЕДСТВА ВЗАИМОДЕЙСТВИЯ С БАЗОЙ ДАННЫХ: #####
##### НОВОЕ: #####
- создание базы данных и 1-2 тестовых таблиц
- application/core/config.php - файл конфигурации приложения (настройки для создания подключения к базе данных)
- application/core/db.php - средство непосредственного взаимодействия с БД (инициализация подключения к БД при создании эземпляра, реализация методов осуществления непосредственных запросов к БД, методы получения последней возникшей ошибки и id последней вставленной/измененной записи
- application/core/loader.php - загрузчик основных часетй фреймворка (загрузка и возвращение экземпляра модели)
- application/core/model.php - абстрактная модель (экземпляры конфигурации, загрузчика и средства для работы с БД в виде полей)
- application/model/ - набор тестовых моделей - наследников абстрактной модели
##### ИЗМЕНЕНИЯ: #####
- application/core/controller.php - абстрактный контроллер (экземпляры конфигурации и загрузчика в виде полей)

-----------------------------------------------------------------

##### 3. СОХРАНЕНИЕ СОСТОЯНИЯ КЛИЕНТА/СЕРВЕРА И РАБОТА С СЕССИЯМИ: #####
##### НОВОЕ: #####
- создание таблиц ползователя(как минимум: id, login, password(зашифрованный)) и сессии(как минимум: id, token, user\_id)
- application/librares/ - набор подключаемых библиотек
- application/librares/login\_library.php - библиотека средств авторизации и сохранения пользователя встроенными средствами php (для бразуера)(работа с $\_SESSIONS, внесение данных в $\_SESSIONS(login), проверка и чтение данных из $\_SESSIONS(authorize), удаление данных из $\_SESSIONS(logout))
- application/core/io.php - инструментарий ввода-вывода (работа с $\_POST, $\_GET, работа с необработанными данными, отправленными методом POST, чтение содержимого файлов)
- application/models/session\_model.php - модель для работы с сессиями (альтернативная система для клиентских приложений) (логин и создане токена и записи сессии, проверка сессии по токену и получение id пользователя, логаут и удаление записи сессии)
- application/models/user\_model.php - модель для работы с пользователем (получение пользователя по id, получение пользователя по логину и паролю) 
- application/controllers/login\_contriller - контроллер авторизации: методы + функции api login и logout (api обменивается с клиентом строкой в фломате JSON)
##### ИЗМЕНЕНИЯ: #####
- application/routes.php - добавление роутов для обращения к функциям api
- application/core/loader.php - загрузчик основных часетй фреймворка (загрузка и возвращение экземпляра библиотеки)
###### ЗАМЕЧЕНИЕ: ######
- user\_model и session\_model работают в связке друг с другом

##### 4. БАЗОВАЯ РАБОТА С КЛИЕНТОМ: #####
> Репозиторий примера клиента на C# [github.com/Alexandr1994/client_csharp_ex](https://github.com/Alexandr1994/client_csharp_ex)

> Репозиторий примера клиента для Android [github.com/Alexandr1994/client_android](https://github.com/Alexandr1994/client_android)

#### ПЕРЕЧЕНЬ ОШИБОК API: ####

##### 1xx - общие ошибки входных данных: #####
- 101 - ошибка парсинга JSON, не валидный JSON;
- 102 - отсутствует необходимая секция токена JSON; 
- 103 - отсутствует необходимая секция данных JSON; 
- 104 - неправильный набор полей секции данных JSON; 
- 105 - невалидный токен; 

##### 2xx - ошибки авторизации/регистрации: #####
- 201 - неправильный логин и/или пароль;
- 202 - невалидный логин;
- 203 - указанный логин уже содержится в базе данных;
- 204 - невалидный e-mail;
- 205 - указанный e-mail уже содержится в базе данных;
- 206 - невалидный паролm
- 207 - ошибка добавления пользователя
- 208 - ошибка создания токена

#### ПЕРЕЧЕНЬ КОМПОНЕНТОВ WEB-ИНТЕРФЕЙСА: ####
- Шаблонизатор [Smarty 3.1.33](https://www.smarty.net/docs/en/) (для работы необходима директории temp/smarty с поддиректриями cache, config, compile (см. настройки Smarty в config.php))
- JS/CSS-фреймворк [Bootstrap 4.1.3](http://bootstrap-4.ru/docs/4.1/getting-started/introduction/)
- JS-библиотека [jQuery 3.3.1](https://api.jquery.com/)
- Коллекция иконок [FontAwesome 4.7](https://fontawesome.com/v4.7.0/icons/)




